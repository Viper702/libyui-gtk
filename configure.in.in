## custom configure.in.in

## initialize
@YAST2-INIT-COMMON@
@YAST2-INIT-PROGRAM@

## some common checks
@YAST2-CHECKS-COMMON@
@YAST2-CHECKS-PROGRAM@

dnl AC_MSG_CHECKING(prefix)
dnl if test "z${prefix}" != "z/usr"; then
dnl   AC_MSG_ERROR(["Only the /usr prefix is supported, sorry. cf. README"])
dnl fi
dnl AC_MSG_RESULT(/usr - good)

dnl pkgconfig
AC_ARG_VAR([PKG_CONFIG_PATH], [where to search for pkg-config files])
dnl devtools
dnl ...
AC_PATH_PROG(PKG_CONFIG, pkg-config)
if test ! -x "$PKG_CONFIG" ; then
   AC_MSG_ERROR([
*** You need the latest pkg-config.
*** Get the latest version of pkg-config from
*** <http://www.freedesktop.org/software/pkgconfig/>.])
fi
AC_SUBST(PKG_CONFIG)


AC_FUNC_ALLOCA
AC_HEADER_STDC

dnl Try to find the Zypp includes
if ! test -d /usr/include/zypp; then
	AC_MSG_ERROR(libzypp-devel not installed.)
fi

PKG_CHECK_MODULES( ZYPP, libzypp )
AC_SUBST(ZYPP_LIBS)

PKG_CHECK_MODULES( GTK, gtk+-2.0 glib-2.0 gthread-2.0 gobject-2.0 )
AC_SUBST(GTK_CFLAGS)
AC_SUBST(GTK_LIBS)

verstxt=`pkg-config --modversion yast2-core`
vers=`echo "$verstxt" | awk -F. '{ printf "%d", ($1 * 1000 + $2) * 1000 + $3;}'`
AC_DEFINE_UNQUOTED(YAST2_VERSION, $vers, [yast version for compile conditionals])

AC_OUTPUT([Makefile src/Makefile])

echo "
Hello hacker: please read the README carefully while this builds.
"
