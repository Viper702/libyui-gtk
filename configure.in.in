## custom configure.in.in

## initialize
@YAST2-INIT-COMMON@
@YAST2-INIT-PROGRAM@

## some common checks
@YAST2-CHECKS-COMMON@
@YAST2-CHECKS-PROGRAM@

dnl AC_MSG_CHECKING(prefix)
dnl if test "z${prefix}" != "z/usr"; then
dnl   AC_MSG_ERROR(["Only the /usr prefix is supported, sorry. cf. README"])
dnl fi
dnl AC_MSG_RESULT(/usr - good)

dnl pkgconfig
AC_ARG_VAR([PKG_CONFIG_PATH], [where to search for pkg-config files])
dnl devtools
dnl ...
AC_PATH_PROG(PKG_CONFIG, pkg-config)
if test ! -x "$PKG_CONFIG" ; then
   AC_MSG_ERROR([
*** You need the latest pkg-config.
*** Get the latest version of pkg-config from
*** <http://www.freedesktop.org/software/pkgconfig/>.])
fi
AC_SUBST(PKG_CONFIG)

AC_FUNC_ALLOCA
AC_HEADER_STDC

PKG_CHECK_MODULES( GTK, gtk+-2.0 glib-2.0 gthread-2.0 gobject-2.0 )
AC_SUBST(GTK_CFLAGS)
AC_SUBST(GTK_LIBS)

# TODO: we may want to check if GtkHtml is installed and set its flag
#dnl Check if GtkHtml is installed
#AC_MSG_CHECKING([for gtkhtml])
#PKG_CHECK_MODULES( GTKHTML, libgtkhtml-3.14 )
#AC_SUBST(GTKHTML_CFLAGS)
#AC_SUBST(GTKHTML_LIBS)
#AC_DEFINE(USE_GTKHTML, 1, [will use GtkHtml as the HTML renderer])

# TODO: we may want to check if WebKit is installed and set its flag
#dnl Check if WebKit is installed
#AC_MSG_CHECKING([for webkit])
#PKG_CHECK_MODULES( WEBKIT, webkit-1.0 )
#AC_SUBST(WEBKIT_CFLAGS)
#AC_SUBST(WEBKIT_LIBS)
#AC_DEFINE(USE_WEBKIT, 1, [will use WebKit as the HTML renderer])

PKG_CHECK_MODULES( ZYPP, libzypp )
AC_SUBST(ZYPP_LIBS)

verstxt=`pkg-config --modversion yast2-libyui`
yast_vers=`echo "$verstxt" | awk -F. '{ printf "%d", ($1 * 1000 + $2) * 1000 + $3;}'`
AC_DEFINE_UNQUOTED(YAST2_VERSION, $yast_vers, [yast version for compile conditionals])

PYUI_LIBS='-lpy2UI'
AC_SUBST(PYUI_LIBS)

AC_OUTPUT([Makefile src/Makefile])

echo "Hello hacker: checkout README while this builds."

